---
import { getCollection } from "astro:content";
import { Page as BaseLayout } from "@levino/shipyard-base/layouts";

type Props = {
  title?: string;
};

const locale = Astro.currentLocale;
const { title } = Astro.props;
const entry = await getCollection("blog")
  .then((posts) =>
    posts.toSorted((a, b) => b.data.date.getTime() - a.data.date.getTime()),
  )
  .then((collection) =>
    collection.reduce(
      (acc, { id, data: { title } }, key) => ({
        ...acc,
        [key]: {
          href: `/${locale}/blog/${id.slice(3)}`,
          label: title,
        },
      }),
      {},
    ),
  );
---

<BaseLayout title={title} sidebarNavigation={entry}>
  <slot />
</BaseLayout>
